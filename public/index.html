<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crash Pro Max</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { background: #0b0e11; color: #fff; font-family: sans-serif; margin: 0; padding: 0; overflow: hidden; height: 100vh; display: flex; flex-direction: column; }
        
        /* ‡¶ü‡¶™ ‡¶¨‡¶æ‡¶∞ */
        .top-bar { width: 100%; background: #1e2329; padding: 10px 0; display: flex; justify-content: space-around; align-items: center; border-bottom: 1px solid #333; position: fixed; top: 0; z-index: 100; height: 40px; }
        .user-info { color: #f0b90b; font-size: 14px; font-weight: bold; }

        /* ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶®‡¶ø‡¶Æ‡ßá‡¶∂‡¶® ‡¶è‡¶∞‡¶ø‡ßü‡¶æ (‡¶Æ‡¶æ‡¶ù‡¶ñ‡¶æ‡¶®‡ßá) */
        .game-area { flex-grow: 1; position: relative; width: 100%; display: flex; justify-content: center; align-items: center; background: radial-gradient(circle, #1a202c 0%, #0b0e11 100%); overflow: hidden; }
        #multiplier { position: absolute; bottom: 30%; font-size: 55px; color: #02c076; font-weight: bold; z-index: 5; text-shadow: 0 0 15px rgba(2, 192, 118, 0.5); }
        
        /* ‡¶™‡ßç‡¶≤‡ßá‡¶® ‡¶ì ‡¶ß‡ßã‡¶Å‡ßü‡¶æ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶®‡¶ø‡¶Æ‡ßá‡¶∂‡¶® */
        #plane { font-size: 50px; position: absolute; left: 10%; bottom: 20%; z-index: 10; transform: rotate(-10deg); transition: all 0.1s linear; }
        .smoke { position: absolute; width: 8px; height: 8px; background: rgba(255,255,255,0.3); border-radius: 50%; animation: smokeMove 0.8s forwards; }
        @keyframes smokeMove { to { transform: translate(-50px, 20px); opacity: 0; } }
        .blast { font-size: 80px !important; animation: blastPop 0.5s forwards; }
        @keyframes blastPop { 0% { transform: scale(1); } 50% { transform: scale(2); opacity: 0.8; } 100% { transform: scale(0); opacity: 0; } }

        /* ‡¶®‡¶ø‡¶ö‡ßá‡¶∞ ‡¶ï‡¶®‡ßç‡¶ü‡ßç‡¶∞‡ßã‡¶≤ ‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ */
        .controls { background: #1e2329; width: 100%; padding: 15px; border-radius: 20px 20px 0 0; border-top: 1px solid #333; z-index: 100; box-sizing: border-box; }
        .bet-input { width: 100%; padding: 12px; background: #2b3139; border: 1px solid #474d57; color: white; border-radius: 8px; margin-bottom: 10px; box-sizing: border-box; font-size: 16px; }
        .btn { width: 100%; padding: 14px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; }
        .btn-bet { background: #02c076; color: white; font-size: 18px; margin-bottom: 12px; }
        .grid-menu { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .btn-menu { background: #2b3139; color: #eaecef; font-size: 14px; }

        /* ‡¶™‡¶™‡¶Ü‡¶™ */
        .popup { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: #1e2329; width: 85%; padding: 20px; border-radius: 15px; border: 2px solid #f0b90b; z-index: 200; }
        .close-btn { background: #f84960; padding: 5px 10px; border-radius: 5px; float: right; cursor: pointer; }
    </style>
</head>
<body>

    <div class="top-bar">
        <div class="user-info">üë§ <span id="userName">User</span></div>
        <div class="balance-info">üí∞ <span id="balanceDisplay">10,000</span> Pts</div>
    </div>

    <div class="game-area" id="gameArea">
        <div id="multiplier">1.00x</div>
        <div id="plane">‚úàÔ∏è</div>
    </div>

    <div class="controls">
        <input type="number" id="betAmount" class="bet-input" placeholder="Enter Points">
        <button class="btn btn-bet" id="betBtn" onclick="handleBet()">PLACE BET</button>

        <div class="grid-menu">
            <button class="btn btn-menu" onclick="triggerAction('Deposit')">Deposit</button>
            <button class="btn btn-menu" onclick="triggerAction('Withdraw')">Withdraw</button>
            <button class="btn btn-menu" onclick="triggerAction('History')">History</button>
            <button class="btn btn-menu" onclick="triggerAction('Profile')">Profile</button>
        </div>
    </div>

    <div id="actionPopup" class="popup">
        <span class="close-btn" onclick="document.getElementById('actionPopup').style.display='none'">X</span>
        <h3 id="popupTitle">Title</h3>
        <div id="popupContent"></div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();
        const user = tg.initDataUnsafe?.user;
        document.getElementById('userName').innerText = user ? user.first_name : "Player";

        const plane = document.getElementById('plane');
        const multiplierText = document.getElementById('multiplier');
        const ads = ["https://otieu.com/4/10315373", "https://www.effectivegatecpm.com/e0xpfuhe?key=fb81fa455f0ff2d6a8fa09ce5d18dd57"];

        let count = 1.00;
        let isCrashed = false;
        let speedX = 0.5;
        let speedY = 0.3;
        let posX = 10;
        let posY = 20;

        function startFlying() {
            isCrashed = false;
            count = 1.00;
            posX = 10; posY = 20;
            plane.innerText = "‚úàÔ∏è";
            plane.className = "";
            plane.style.display = "block";
            
            const flyLoop = setInterval(() => {
                if (isCrashed) {
                    clearInterval(flyLoop);
                    return;
                }
                
                count += 0.01;
                multiplierText.innerText = count.toFixed(2) + "x";
                
                // ‡¶™‡ßç‡¶≤‡ßá‡¶® ‡¶Æ‡ßÅ‡¶≠‡¶Æ‡ßá‡¶®‡ßç‡¶ü (‡¶®‡¶ø‡¶ö ‡¶•‡ßá‡¶ï‡ßá ‡¶â‡¶™‡¶∞‡ßá)
                posX += 0.2;
                posY += 0.15;
                plane.style.left = posX + "%";
                plane.style.bottom = posY + "%";

                // ‡¶ß‡ßã‡¶Å‡ßü‡¶æ ‡¶§‡ßà‡¶∞‡¶ø
                createSmoke(posX, posY);

                // ‡¶∞‚Äç‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶°‡¶Æ ‡¶ï‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶∂ ‡¶≤‡¶ú‡¶ø‡¶ï
                if (count > (Math.random() * 5 + 1.5)) {
                    crashPlane();
                }
            }, 100);
        }

        function createSmoke(x, y) {
            const smoke = document.createElement('div');
            smoke.className = 'smoke';
            smoke.style.left = x + "%";
            smoke.style.bottom = y + "%";
            document.getElementById('gameArea').appendChild(smoke);
            setTimeout(() => smoke.remove(), 800);
        }

        function crashPlane() {
            isCrashed = true;
            plane.innerText = "üí•";
            plane.classList.add('blast');
            multiplierText.style.color = "#f84960";
            setTimeout(() => {
                multiplierText.style.color = "#02c076";
                startFlying();
            }, 3000);
        }

        function triggerAction(type) {
            // ‡¶¨‡¶æ‡¶ü‡¶® ‡¶´‡¶ø‡¶ï‡ßç‡¶∏: ‡¶ü‡ßá‡¶≤‡¶ø‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ ‡¶™‡¶™‡¶Ü‡¶™ ‡¶¶‡¶ø‡ßü‡ßá ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶ì‡¶™‡ßá‡¶®
            tg.showConfirm(`Unlock ${type} by viewing ads?`, (ok) => {
                if(ok) {
                    window.open(ads[0], '_blank');
                    setTimeout(() => {
                        window.open(ads[1], '_blank');
                        showPopup(type);
                    }, 1000);
                }
            });
        }

        function showPopup(type) {
            const p = document.getElementById('actionPopup');
            document.getElementById('popupTitle').innerText = type;
            document.getElementById('popupContent').innerHTML = `<p>${type} details here...</p><input class='bet-input' placeholder='Enter data'>`;
            p.style.display = 'block';
        }

        function handleBet() {
            const btn = document.getElementById('betBtn');
            if(btn.innerText === "PLACE BET") {
                btn.innerText = "CASH OUT";
                btn.style.background = "#eab308";
            } else {
                btn.innerText = "PLACE BET";
                btn.style.background = "#02c076";
                alert("Win: " + multiplierText.innerText);
            }
        }

        startFlying();
    </script>
</body>
</html>
