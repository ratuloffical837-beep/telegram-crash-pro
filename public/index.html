<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Crash Pro Ultimate Loop</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root { --bg: #0b0e11; --card: #1e2329; --yellow: #f0b90b; --green: #02c076; --red: #f84960; --text: #eaecef; }
        body { background: var(--bg); color: var(--text); font-family: sans-serif; margin: 0; padding: 0; overflow: hidden; height: 100vh; display: flex; flex-direction: column; }
        
        /* ‡¶ü‡¶™ ‡¶¨‡¶æ‡¶∞ */
        .top-bar { width: 100%; background: var(--card); padding: 10px; display: flex; justify-content: space-between; position: fixed; top: 0; z-index: 1000; border-bottom: 1px solid #333; }
        
        /* ‡¶ó‡ßá‡¶Æ ‡¶è‡¶∞‡¶ø‡ßü‡¶æ */
        .game-view { flex-grow: 1; position: relative; width: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center; margin-bottom: 250px; }
        #multiplier { font-size: 60px; color: var(--green); font-weight: 800; z-index: 5; }
        #status-msg { font-size: 18px; color: var(--yellow); margin-top: 10px; font-weight: bold; }

        /* ‡¶™‡ßç‡¶≤‡ßá‡¶® */
        #plane-container { position: absolute; left: 10%; bottom: 25%; z-index: 10; display: none; }
        #plane { font-size: 45px; transform: rotate(-10deg); }

        /* ‡¶ï‡¶®‡ßç‡¶ü‡ßç‡¶∞‡ßã‡¶≤ ‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ */
        .bottom-panel { background: var(--card); width: 100%; padding: 15px; border-radius: 20px 20px 0 0; position: fixed; bottom: 0; z-index: 1000; border-top: 1px solid #333; }
        .bet-box { width: 100%; padding: 12px; background: #2b3139; border: 1px solid #474d57; color: white; border-radius: 10px; margin-bottom: 10px; }
        .main-btn { width: 100%; padding: 15px; border: none; border-radius: 10px; font-weight: bold; font-size: 18px; cursor: pointer; }
        .btn-bet { background: var(--green); color: white; }
        
        /* ‡¶¨‡¶æ‡¶ü‡¶® ‡¶ó‡ßç‡¶∞‡¶ø‡¶° */
        .menu-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-top: 10px; }
        .menu-btn { background: #2b3139; color: var(--text); border: none; padding: 12px; border-radius: 8px; font-size: 14px; cursor: pointer; }

        /* ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶™‡ßã‡¶∏‡ßç‡¶ü‡¶æ‡¶∞ / ‡¶Ü‡¶á‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡¶™‡¶™‡¶Ü‡¶™ */
        .ad-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 5000; flex-direction: column; align-items: center; justify-content: center; }
        .ad-box { width: 90%; height: 70%; background: #fff; border-radius: 10px; overflow: hidden; position: relative; }
        iframe { width: 100%; height: 100%; border: none; }
        #skip-btn { display: none; margin-top: 15px; background: var(--yellow); color: #000; padding: 10px 30px; border-radius: 5px; font-weight: bold; cursor: pointer; }
        #ad-timer { color: #fff; margin-top: 10px; font-size: 14px; }
    </style>
</head>
<body>

    <div class="top-bar">
        <span>üë§ <span id="uName">Player</span></span>
        <span>üí∞ <span id="uBalance">10,000</span></span>
    </div>

    <div class="game-view">
        <div id="multiplier">Next Round...</div>
        <div id="status-msg">Waiting for Bets</div>
        <div id="plane-container"><div id="plane">‚úàÔ∏è</div></div>
    </div>

    <div class="bottom-panel">
        <input type="number" id="bAmount" class="bet-box" placeholder="Enter Bet Points">
        <button class="main-btn btn-bet" id="betBtn" onclick="placeBet()">PLACE BET</button>

        <div class="menu-grid">
            <button class="menu-btn" onclick="showAdPopup('Deposit')">Deposit</button>
            <button class="menu-btn" onclick="showAdPopup('Withdraw')">Withdraw</button>
            <button class="menu-btn" onclick="showAdPopup('History')">History</button>
            <button class="menu-btn" onclick="showAdPopup('Profile')">Profile</button>
        </div>
    </div>

    <div id="adOverlay" class="ad-overlay">
        <div class="ad-box">
            <iframe id="adFrame" src=""></iframe>
        </div>
        <div id="ad-timer">Wait <span id="sec">15</span> seconds...</div>
        <div id="skip-btn" onclick="closeAd()">SKIP AD</div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();
        
        const ads = ["https://otieu.com/4/10315373", "https://www.effectivegatecpm.com/e0xpfuhe?key=fb81fa455f0ff2d6a8fa09ce5d18dd57"];
        let isBettingOpen = true;
        let gameRunning = false;

        // ‡¶ó‡ßá‡¶Æ ‡¶∏‡¶æ‡¶á‡¶ï‡ßá‡¶≤ (‡ßß‡ß¶ ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶° ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡¶°‡¶æ‡¶â‡¶®)
        function startCountdown() {
            isBettingOpen = true;
            gameRunning = false;
            let timeLeft = 10;
            document.getElementById('plane-container').style.display = 'none';
            document.getElementById('multiplier').style.color = 'var(--yellow)';
            
            let timer = setInterval(() => {
                document.getElementById('multiplier').innerText = timeLeft + "s";
                document.getElementById('status-msg').innerText = "Place Your Bets!";
                timeLeft--;
                if(timeLeft < 0) {
                    clearInterval(timer);
                    startGame();
                }
            }, 1000);
        }

        function startGame() {
            isBettingOpen = false;
            gameRunning = true;
            let count = 1.00;
            let pX = 10, pY = 25;
            document.getElementById('multiplier').style.color = 'var(--green)';
            document.getElementById('plane-container').style.display = 'block';
            document.getElementById('status-msg').innerText = "Plane is Flying!";

            let flyLoop = setInterval(() => {
                if(!gameRunning) { clearInterval(flyLoop); return; }
                count += 0.01;
                document.getElementById('multiplier').innerText = count.toFixed(2) + "x";
                
                pX += 0.15; pY += 0.1;
                document.getElementById('plane-container').style.left = pX + "%";
                document.getElementById('plane-container').style.bottom = pY + "%";

                if(count > (Math.random() * 4 + 1.2).toFixed(2)) {
                    gameRunning = false;
                    document.getElementById('plane').innerText = "üí•";
                    document.getElementById('multiplier').style.color = 'var(--red)';
                    document.getElementById('status-msg').innerText = "CRASHED!";
                    setTimeout(() => {
                        document.getElementById('plane').innerText = "‚úàÔ∏è";
                        startCountdown();
                    }, 3000);
                }
            }, 100);
        }

        // ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ
        function showAdPopup(type) {
            const overlay = document.getElementById('adOverlay');
            const frame = document.getElementById('adFrame');
            const skip = document.getElementById('skip-btn');
            const timerMsg = document.getElementById('ad-timer');
            let sec = 15;

            // ‡¶∞‚Äç‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶°‡¶Æ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï ‡¶≤‡ßã‡¶°
            frame.src = ads[Math.floor(Math.random() * ads.length)];
            overlay.style.display = 'flex';
            skip.style.display = 'none';
            timerMsg.style.display = 'block';

            let adTimer = setInterval(() => {
                sec--;
                document.getElementById('sec').innerText = sec;
                if(sec <= 0) {
                    clearInterval(adTimer);
                    timerMsg.style.display = 'none';
                    skip.style.display = 'block';
                }
            }, 1000);
        }

        function closeAd() {
            document.getElementById('adOverlay').style.display = 'none';
            document.getElementById('adFrame').src = "";
            tg.showAlert("Action Unlocked!");
        }

        function placeBet() {
            if(!isBettingOpen) {
                tg.showAlert("Betting Closed! Wait for next round.");
                return;
            }
            tg.showAlert("Bet Placed Successfully!");
        }

        startCountdown();
    </script>
</body>
    </html>
